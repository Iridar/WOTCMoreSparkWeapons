Created by Iridar, as voted by patrons.

More info at: https://www.patreon.com/Iridar

/*
Credits:

*/


Adds new weapons and tools for SPARKs and MEC Troopers.
- Ordnance Launcher - secondary weapon, can be used to launch grenades and rockets, adds grenade-only slots to carry ammunition. Can be used to fire the [b]Bombard[/b] ability.
- Kinetic Strike Module - secondary weapon, boosts melee damage from Strike ability, if learned. Adds its own Kinestic Strike ability that can be used to target an adjacent tile. Has special death animations for a few enemies.
- New Heavy Weapon - Kiruka Autogun - works more or less like a normal automatic weapon, but with infinite ammo. Can deal Headshots to Lost. Generally meant as a sort of a sidearm. Can be used by regular soldiers as well.
- BIT is now optional. It is required for hacking and repair. If you unequip the BIT, you lose the Heavy Weapon slot. BIT's bonus to hacking is boosted to be slightly below Specialists', and BIT now provides Active Camo ability, that (for now) works like Phantom.
- New inventory slot for SPARKs and MECs - Auxiliary Weapon. Can be used to house a Heavy Weapon (fired from the SPARK's arm, regardless if you have a BIT or not), to carry an extra grenade/rocket with Ordnance Launcher equipped, to carry a SPARK Launcher from SPARK Launchers Redux mod, or to carry one of the two new tools:
-- Restorative Mist - heals organics around the SPARK. If BIT is equipped, heals organics in a targeted area at range.
-- EM Pulse - temporarily shuts down robotic enemies around the SPARK. If BIT is equipped, applies same effects in a targeted area. SPARK itself is not affected, but other allied robotics are.

[WOTC] Iridar's SPARK Arsenal
[h1]FEATURES[/h1]

Adds new weapons and tools for SPARKs and [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1452700934]MEC Troopers[/url][/b], adds a new Inventory Slot, and makes some changes to BITs. This mod is a significant buff to SPARKs' and MECs' power, so balance the game accordingly.

Every change performed by this mod affects SPARKs and MEC Troopers equally.

[h1]Ordnance Launchers[/h1]

New Secondary Weapons, capable of launching Grenades and [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1775963384]Rockets[/url][/b]. Add 2 Grenade-only slots when equipped.

There are three tiers of Ordnance Launchers. Unless configured otherwise, available from the start of the campaign for free in infinite quantities, upgraded automatically with SPARK armor. 
Similar to Grenade Launchers, Ordnance Launchers provide a boost to grenades' range and radius. Additionally, tier 3 Ordnance Launcher uses Blaster Launcher targeting to deliver grenades, much like the [url=https://steamcommunity.com/sharedfiles/filedetails/?id=1181681128][b]Beam Grenade Launcher[/b][/url].

[h1]Kinetic Strike Module[/h1]

New Secondary Weapon, grants [b]Kinetic Strike[/b] ability that works similarly to Enemy Within - target an adjacent tile, and everything on it gets pulverized. Its damage scales with SPARK Armor, same as for the [b]Strike[/b] ability. Having a KSM equipped also passively boosts damage of other melee abilities, such as the mentioned [b]Strike[/b].

Kinetic Strike ability has unique kill/death animations for some enemies. I made it possible for third party mods to supply their own unique animations through config. If you're modder and are interested in adding some, please [b][url=]read this[/url][/b].

There is only one tier of KSM, it can be built in Engineering one at a time after ADVENT MEC autopsy.

[h1]Kiruka Autogun[/h1]

New Heavy Weapon, can be used by regular soldiers as well. Works like a regular automatic weapon with infinite ammo, meant to be a backup weapon, a "heavy sidearm" of sorts. Capable of Headshotting the Lost and benefits from special ammo, but cannot crit.

Integrated as a regular Heavy Weapon that can be acquired from the [b]Experimental Heavy Weapon[/b] and [b]Powered Heavy Weapon[/b] proving grounds project. Regular Autogun deals 3-4 damage, Powered Autogun deals 4-5.

Benefits from [b]Quickdraw[/b], [b]Salvo[/b] and [b]Marauder[/b] abilities, as well as [b]Rainmaker[/b], which adds +2 damage and makes Autogun attacks hit in a 3x3 tile square around the target.

[h1]Arm Cannon[/h1]

This mod adds an Arm Cannon model and animations that are used to fire Heavy Weapons carried in the Auxiliary Weapon Slot, or all equipped Heavy Weapons if a BIT is not equipped.

Arm Cannon model and animations are added automatically, you don't need to equip any additional items for them to work. 

[h1]Auxiliary Weapon Slot[/h1]

New Inventory Slot for SPARKs and MECs. Can be used to carry:[list]
[*] [b]Heavy Weapon[/b] - a heavy weapon carried in the aux slot will be fired from the SPARK's arm cannon.
[*] [b]Restorative Mist[/b] and [b]E.M. Pulse[/b] - described below.
[*] [b]Rockets[/b] - can always be carried in the aux slot so that SPARKs can Give them to other soldiers.
[*] [b]Grenades[/b] - can be carried in the aux slot if an Ordnance Launcher is equipped.
[*] [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1161324428]SPARK Launchers Redux[/url][/b] - by RealityMachina[/list]

[h1]Restorative Mist[/b]

An auxiliary "weapon". Heals +3 HP for organic units around the SPARK. If a BIT is equipped, it can be used to deploy the Restorative Mist in a target area some distance away from the SPARK. 1 Charge per mission.
Can be built in Engineering one at a time, much like a Medkit. Upgraded by [b]Battlefield Medicine[/b] proving grounds project to heal for +5 HP.

[h1]E.M. Pulse[/h1]

An auxiliary "weapon". Disables weapons and Shieldbearers' [b]Energy Shields[/b] for all units around the spark. Robotic units are also shut down for a turn. SPARK itself is not affected, but other allied robotic units are, including [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1293725945]Augmented soldiers[/url][/b], so use with caution. If a BIT is equipped, it can be used to deploy the E.M. Pulse in a target area some distance away from the SPARK. 1 Charge per mission. 

Can be built in Engineering one at a time after you complete [b]Bluescreen Protocol[/b] proving grounds project.

[h1]BIT REBALANCE[/h1]

SPARKs and MECs without a BIT lose their Heavy Weapon Slot, cannot hack, and their detection radius is increased significantly. They still start missions concealed along with the rest of the squad, but it's much harder for them to keep the concealment as they move around the map.
[b]Intrusion Protocol[/b] and [b]Arsenal[b] squaddie abilities have been moved from the SPARKs' ability tree to the BIT to relay these changes.

BITs now grant an additional ability: [b]Active Camo[/b] - reduces detection radius and allows the to retain concealment if the squad is revealed, much like the [b]Phantom[/b] ability.

BITs' bonus to Hacking stat is increased from 0 / 10 / 20 to 40 / 60/ 80. SPARKs still can't hack as good as Specialists, especially in the late game, but now they actually have a decent to chance to get a hack reward on low difficulty hacks.

List of abilities that cannot be used without a BIT:[list]
[*][b]Repair[/b][/list]

[h1]OTHER NOTES[/h1]

This mod is balanced around the expectation that SPARKs and MEC Troopers do not have Utility Slots. So if another mod adds some Utility Slots that lets you carry more than 2-3 grenades/rockets, please do not complain that it's overpowered, that is not the intended behavior for this mod, although it is possible, so if that's what you want, by all means.

[h1]REQUIREMENTS[/h1]
[list]
[*] [url=https://steamcommunity.com/sharedfiles/filedetails/?id=1796402257][b][BETA] X2WOTCCommunityHighlander[/b][/url] v1.21 or higher is required.[/list]
[*] [b]Shen's Last Gift DLC[/b] is required. No, seriously.[/list]

[h1]COMPANION MODS[/h1]
[list]
[*] [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1775963384][WOTC] Rocket Launchers 2.0[/url][/b] - fully supported. This mod enables SPARKs to carry, Take, Arm and Give rockets, as well as Fire them with the Ordnance Launcher. SPARKs do not suffer movement penalties for carrying rockets. All rockets are supported, including the Tactical Elerium Nuke. Judgement Day is upon ADVENT.
[*] [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1161324428]SPARK Launchers Redux[/url][/b] - in a weak attempt to keep things more balanced, my mod nerfs SPARK Launchers' charges to 1 for offensive launchers and 2 for support launchers, and repurposes them to be carried in the Auxiliary Weapon slot.
[*] [b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=2025921415][WOTC] Grenade Rebalance[/url][/b] - makes same changes to Ordnance Launchers as to Grenade Launchers
[/list]

[h1]COMPATIBILITY[/h1]

I tried to keep the mod as compatible as possible, including all the major overhauls. For compatibility notes with specific mods please [b][url=]go here[/url][/b].

[h1]KNOWN ISSUES[/h1]
[list]
[*] Currently none.[/list]

[h1]CONFIGURATION[/h1]

The mod is [b][i]highly[/i][/b] configurable through various files in:
[code]..\steamapps\workshop\content\268500\1961379529\Config\[/code][list]

[h1]CREDITS[/h1]

First of all, huge thanks to my [b][url=https://www.patreon.com/Iridar]patrons on patreon[/url[/b] for producing this mod. It's a [b][i]blast[/i][/b] to work with so many wonderful people. Particularly:
[b]Arkhangel[/b], [b]lago508[/b], [b]Chris the Thin Mint[/b] and [b]Wolfcub05[/b] - feedback and ideas.
[b]Kiruka[/b] - a long time patron, requested the Autogun to make SPARKs better equipped to deal with the Lost. I named the weapon after her as a sign of appreciation for her support.

[b]Musashi[/b] - for graciously providing the custom death animation code. 
[b]NeIVIeSiS[/b] - for making all the ability icons for this mod.
[b]bstar[/b] - brainstorm assistance.


[h1]KSM Custom Death Animations[/h1]

When [b]Kinetic Strike[/b] ability kills an enemy, custom kill/death animations will play, if possible. These custom animations may inexplicably fail to play in some circumstances, in which case the game should default to regular kill/death animations.

Custom animations are configured via [b]XComKineticStrikeModule.ini[/b] by adding [b]KSMSpecialDeathAnimation[/b] entries, for example:

[WOTCMoreSparkWeapons.KSMHelper]
+KSMSpecialDeathAnimation = (CharacterTemplateName = "AdvTrooper", KillSequence = "FF_KSMKill_TrooperA", DeathSequence = "FF_KSMDeath_TrooperA", DeathAnimSet = "IRIKineticStrikeModule.Anims.AS_Trooper_Death")

Currently available parameters are:[list]
[*] [b]CharacterTemplateName[/b] - character template name of the unit that should play the custom death animation when killed by Kinetic Strike. By default, partially matching template names are accepted. E.g. "AdvTrooper" will work for AdvTrooperM1, AdvTrooperM2 and AdvTrooperM3.
[*] [b]bStrictMatch[/b] - if this is "true", only character templates with exactly matching template names will be accepted. This can be used, for example, if you want a "Muton" to be affected, but a "MutonCenturion" - not.
[*] [b]KillAnimSet[/b] - path to an AnimSet that will contain a custom kill animation that will be used by the SPARK / MEC Trooper. It's not necessary to specify the AnimSet if it is already applied to the unit via any means. Refer to "IRIKineticStrikeModule.Anims.AS_KSM_Pawn" for examples on how custom kill animations should look like. Note that in this case the NotifyTarget (UnitHit) AnimNotify will signal the game when to start playing the custom death animation.
[*] [b]KillSequence[/b] - name of the animsequence that will be played by the unit to kill the target. 
[*] [b]DeathAnimSet[/b] - path to an AnimSet that will contain a custom death animation. Similarly, there is no need to specify the path if the target already has that AnimSet applied.
[*] [b]DeathSequence[/b] - name of the custom death animsequence.
[/list]

If a character template has several KSMSpecialDeathAnimation entries, one will be selected at random each time the unit of that template is killed.

[h1]Mod Compatibility[/h1]

[url=https://steamcommunity.com/sharedfiles/filedetails/?id=1499767042][b][WOTC] Mechatronic Warfare: Total SPARK Overhaul[/b][/url]

[url=https://steamcommunity.com/sharedfiles/filedetails/?id=1537675645][b]A Better Barracks: TLE[/b][/url] - nothing incompatible on the first glance, but no playtesting has been done.

[b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1452700934]MEC Troopers[/url][/b] 

[b][url=https://steamcommunity.com/sharedfiles/filedetails/?id=1125117203]Metal Over Flesh Redux[/url][/b] 

[url=https://steamcommunity.com/sharedfiles/filedetails/?id=1383408046][b]Honey's Heavy Support Items [WOTC][/b][/url]

[url=https://steamcommunity.com/sharedfiles/filedetails/?id=1891339003][b]Bitterfrost Protocol[/b][/url] - adds a Freeze Rocket Heavy Weapon.
